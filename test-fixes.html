<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Test Fixes</title>
  <style>
    body {
      background: #000;
      color: #0f0;
      font-family: monospace;
      padding: 20px;
    }
    .test-section {
      margin: 20px 0;
      padding: 10px;
      border: 1px solid #0f0;
    }
    button {
      background: #0f0;
      color: #000;
      padding: 10px 20px;
      margin: 5px;
      cursor: pointer;
      border: none;
      font-weight: bold;
    }
    button:hover {
      opacity: 0.8;
    }
    .result {
      margin-top: 10px;
      padding: 10px;
      background: #111;
      border: 1px dashed #0f0;
    }
  </style>
</head>
<body>
  <h1>üß™ Asteroid Dodger - Fix Verification</h1>

  <div class="test-section">
    <h2>Test 1: Generate Sample Data</h2>
    <p>Test if generate sample data works without errors</p>
    <button onclick="testGenerateData()">Test Generate Data</button>
    <div id="result1" class="result"></div>
  </div>

  <div class="test-section">
    <h2>Test 2: Pause/Resume Button Text</h2>
    <p>Test if pause button updates text correctly</p>
    <button onclick="testPauseButton()">Test Pause Button Logic</button>
    <div id="result2" class="result"></div>
  </div>

  <div class="test-section">
    <h2>Test 3: Instructions Modal Display</h2>
    <p>Test if instructions modal can be shown and hidden</p>
    <button onclick="testInstructionsModal()">Test Instructions Modal</button>
    <div id="result3" class="result"></div>
  </div>

  <div class="test-section">
    <button onclick="document.location.href='http://localhost:8000'">Back to Game</button>
  </div>

  <script type="module">
    import * as api from './js/api.js';

    window.testGenerateData = async function() {
      const result = document.getElementById('result1');
      result.innerHTML = '‚è≥ Testing...';
      try {
        // Test creating multiple players with scores
        const playerCount = 3;
        const asteroidCount = 2;
        
        const promises = [];
        for (let i = 0; i < playerCount; i++) {
          const name = `TestPlayer${Date.now()}_${i}`;
          const score = Math.floor(Math.random() * 100);
          promises.push(api.postScore(name, score));
        }

        const sizes = ['Small', 'Medium', 'Large'];
        const materials = ['Rock', 'Iron', 'Crystal'];
        const types = ['Normal', 'Rare', 'Boss'];

        for (let i = 0; i < asteroidCount; i++) {
          const asteroid = {
            size: sizes[Math.floor(Math.random() * sizes.length)],
            speed: Math.floor(Math.random() * 10) + 1,
            material: materials[Math.floor(Math.random() * materials.length)],
            type: types[Math.floor(Math.random() * types.length)],
            spawnRate: Math.floor(Math.random() * 100) + 1
          };
          promises.push(api.addAsteroid(asteroid));
        }

        await Promise.all(promises);
        result.innerHTML = '‚úÖ SUCCESS: Generated ' + playerCount + ' players and ' + asteroidCount + ' asteroids without errors!';
      } catch (err) {
        result.innerHTML = '‚ùå FAILED: ' + err.message;
      }
    };

    window.testPauseButton = function() {
      const result = document.getElementById('result2');
      
      // Mock game state
      let gameState = { paused: false, running: true };
      
      // Mock callbacks
      const callbacks = {
        getGameState: () => gameState,
        onTogglePause: () => {
          gameState.paused = !gameState.paused;
        }
      };

      // Simulate button click with setTimeout logic
      callbacks.onTogglePause();
      
      setTimeout(() => {
        const state = callbacks.getGameState();
        if (state.paused) {
          if (result.innerHTML.includes('Resume Game')) {
            result.innerHTML = '‚úÖ SUCCESS: Button text correctly changed to "Resume Game"';
          } else {
            result.innerHTML = '‚è≥ State changed to paused (expected Resume Game)';
          }
        } else {
          result.innerHTML = '‚ùå FAILED: Pause state not toggled correctly';
        }
      }, 10);

      result.innerHTML = '‚è≥ Testing pause button logic...';
    };

    window.testInstructionsModal = function() {
      const result = document.getElementById('result3');
      const modal = document.getElementById('instructionsModal');
      
      if (!modal) {
        result.innerHTML = '‚ùå FAILED: Instructions modal element not found';
        return;
      }

      // Test showing modal
      modal.classList.add('active');
      const isVisible1 = window.getComputedStyle(modal).display !== 'none' || modal.classList.contains('active');
      
      if (!isVisible1) {
        result.innerHTML = '‚ö†Ô∏è  Modal element added active class, checking CSS...';
      } else {
        result.innerHTML = '‚úÖ SUCCESS: Modal shows when active class is added. ';
      }

      // Test hiding modal
      setTimeout(() => {
        modal.classList.remove('active');
        const isHidden = !modal.classList.contains('active');
        
        if (isHidden) {
          result.innerHTML += '<br>‚úÖ SUCCESS: Modal hides when active class is removed.';
        }
      }, 100);
    };
  </script>
</body>
</html>
