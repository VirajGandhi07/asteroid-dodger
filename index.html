<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Asteroid Dodger</title>

  <!-- Master CSS file (imports all others) -->
  <link rel="stylesheet" href="./css/main.css">
  
  <!-- Critical inline CSS for menu visibility - MUST be after main.css -->
  <style>
    /* Override to ensure menus hide/show properly */
    #mainMenu, #playMenu, #gameOverMenu, #scoreboardMenu, #asteroidsMenu, 
    #asteroidsList, #generateMenu {
      display: none !important;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.95);
      z-index: 1000;
      align-items: center;
      justify-content: center;
      flex-direction: column;
    }

    /* Instructions modal should be above game but available anytime */
    #instructionsModal {
      display: none !important;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.95);
      z-index: 5000;
      align-items: center;
      justify-content: center;
      flex-direction: column;
    }

    /* Login modal should be above everything */
    #loginModal {
      display: flex !important;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.98);
      z-index: 10000;
      align-items: center;
      justify-content: center;
      flex-direction: column;
    }

    /* Hide login modal when user is authenticated */
    #loginModal.hidden {
      display: none !important;
    }
    
    #mainMenu.active, #playMenu.active, #gameOverMenu.active, #scoreboardMenu.active, 
    #asteroidsMenu.active, #asteroidsList.active, #generateMenu.active, 
    #instructionsModal.active {
      display: flex !important;
    }
    
    /* Ensure modals are hidden by default and appear above menus */
    #inputModal, #confirmModal, #alertModal {
      display: none !important;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      align-items: center;
      justify-content: center;
      z-index: 20000; /* above menus */
    }

    #inputModal.active, #confirmModal.active, #alertModal.active {
      display: flex !important;
    }
    
    /* Ensure menu panel styling */
    .menu-panel {
      background: #111;
      border: 3px solid #0f0;
      border-radius: 15px;
      padding: 40px;
      max-width: 550px;
      text-align: center;
      box-shadow: 0 0 30px rgba(0, 255, 0, 0.6), inset 0 0 20px rgba(0, 255, 0, 0.1);
      color: #fff;
    }
    
    .menu-panel h2 {
      font-size: 2em;
      margin-bottom: 30px;
      text-shadow: 0 0 10px #0f0;
      color: #0f0;
      font-family: 'Trebuchet MS', sans-serif;
    }
    
    .menu-buttons {
      display: flex;
      flex-direction: column;
      gap: 15px;
      margin-bottom: 20px;
    }
    
    .menu-btn {
      background: #222;
      color: #0f0;
      border: 2px solid #0f0;
      padding: 15px 25px;
      font-size: 1.1em;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: bold;
      text-transform: uppercase;
      letter-spacing: 1px;
      box-shadow: 0 4px 15px rgba(0, 255, 0, 0.3);
      font-family: 'Trebuchet MS', sans-serif;
      width: 100%;
      display: block;
    }
    
    .menu-btn:hover {
      background: #0f0;
      color: #000;
      box-shadow: 0 0 20px rgba(0, 255, 0, 0.9), inset 0 0 10px rgba(0, 255, 0, 0.3);
      transform: translateY(-2px);
    }
    
    .menu-btn:active {
      transform: translateY(0);
    }
    
    /* Players List Styling */
    .players-list-content {
      text-align: left;
      background: rgba(0, 0, 0, 0.5);
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 20px;
      max-height: 400px;
      overflow-y: auto;
      border: 1px solid #0f0;
      box-shadow: inset 0 0 10px rgba(0, 255, 0, 0.1);
    }
    
    .player-item {
      background: #222;
      border: 1px solid #0f0;
      border-radius: 5px;
      padding: 12px;
      margin-bottom: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      color: #0f0;
      font-family: 'Trebuchet MS', sans-serif;
    }
    
    .player-name {
      font-weight: bold;
      flex: 1;
    }
    
    .player-actions {
      display: flex;
      gap: 8px;
    }
    
    .player-action-btn {
      background: #0f0;
      color: #000;
      border: none;
      padding: 6px 12px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.9em;
      font-weight: bold;
      transition: all 0.2s ease;
      font-family: 'Trebuchet MS', sans-serif;
    }
    
    .player-action-btn:hover {
      background: #fff;
      box-shadow: 0 0 10px rgba(0, 255, 0, 0.8);
    }
    
    .player-action-btn:active {
      transform: scale(0.95);
    }
    
    /* Input/Confirm/Alert Modal Styling */
    .input-modal-panel, .confirm-modal-panel, .alert-modal-panel {
      max-width: 450px;
      padding: 30px;
    }
    
    .input-form {
      margin: 20px 0;
    }
    
    .input-field {
      width: 100%;
      padding: 12px;
      border: 2px solid #0f0;
      background: #111;
      color: #0f0;
      font-size: 1em;
      border-radius: 5px;
      font-family: 'Trebuchet MS', sans-serif;
      box-sizing: border-box;
      margin-bottom: 15px;
    }
    
    .input-field:focus {
      outline: none;
      box-shadow: 0 0 15px rgba(0, 255, 0, 0.6);
    }
    
    .input-field::placeholder {
      color: #0f0;
      opacity: 0.5;
    }
    
    .input-buttons, .confirm-buttons {
      display: flex;
      gap: 10px;
      justify-content: center;
    }
    
    .input-buttons .menu-btn, .confirm-buttons .menu-btn {
      flex: 1;
    }
    
    .confirm-modal-panel, .alert-modal-panel {
      text-align: center;
    }
  </style>
</head>

<body>

  <!-- LOGIN MODAL -->
  <div id="loginModal" class="login-modal-overlay">
    <div class="login-modal-panel">
      <h1 class="login-title">ASTEROID DODGER</h1>
      
      <div id="loginForm" class="auth-form">
        <h2>Login</h2>
        <input type="email" id="loginEmail" placeholder="Email" required>
        <input type="password" id="loginPassword" placeholder="Password" required>
        <button id="loginBtn" class="auth-btn login-btn">Login</button>
        <p class="auth-toggle">Don't have an account? <a id="toggleSignup">Sign Up</a></p>
      </div>

      <div id="signupForm" class="auth-form" style="display:none;">
        <h2>Sign Up</h2>
        <input type="text" id="signupName" placeholder="Full Name" required>
        <input type="email" id="signupEmail" placeholder="Email" required>
        <input type="password" id="signupPassword" placeholder="Password (min 6 chars)" required>
        <input type="password" id="signupConfirm" placeholder="Confirm Password" required>
        <button id="signupBtn" class="auth-btn signup-btn">Sign Up</button>
        <p class="auth-toggle">Already have an account? <a id="toggleLogin">Login</a></p>
      </div>

      <div id="demoInfo" class="demo-info">
        <p><strong>Admin Account:</strong></p>
        <p>Email: demo@test.com</p>
        <p>Password: demo123</p>
      </div>
    </div>
  </div>

  <!-- GAME TITLE -->
  <h1 class="game-title">Asteroid Dodger</h1>


  <!-- GAME CANVAS (hidden until game starts) -->
  <canvas id="gameCanvas" width="800" height="400" style="display:none;"></canvas>


  <!-- VOLUME CONTROLS (hidden until game starts) -->
  <div id="volumeControls" aria-label="Volume Controls" style="display:none;">
    <button id="volDown" title="Decrease Volume">ðŸ”‰</button>
    <button id="volUp" title="Increase Volume">ðŸ”Š</button>
    <button id="muteBtn" title="Mute Sound">ðŸ”‡</button>
  </div>


  <!-- GAME BUTTONS (hidden until game starts) -->
  <div id="gameButtons" class="game-buttons" style="display:none;">
    <button id="pauseBtn">Pause Game</button>
    <button id="newGameBtn">New Game</button>
    <button id="mainMenuBtn">Main Menu</button>
    <button id="instructionsBtn">Instructions</button>
  </div>


  <!-- MAIN MENU OVERLAY -->
  <div id="mainMenu" role="dialog" aria-label="Main Menu" class="menu-overlay active">
    <div class="menu-panel">
      <h2>Asteroid Dodger</h2>
      <div class="menu-buttons">
        <button class="menu-btn" data-action="play">1. Play</button>
        <button class="menu-btn" data-action="scoreboard">2. Scoreboard</button>
        <button class="menu-btn admin-only" id="generateBtn" data-action="generate" style="display:none;">3. Generate Sample Data</button>
        <button class="menu-btn" data-action="instructions">4. How to Play</button>
        <button class="menu-btn" data-action="exit">5. Exit</button>
      </div>
    </div>
  </div>

  <!-- GAME OVER MENU OVERLAY -->
  <div id="gameOverMenu" role="dialog" aria-label="Game Over Menu" class="menu-overlay">
    <div class="menu-panel">
      <h2>GAME OVER</h2>
      <div style="margin: 30px 0; font-size: 1.5em; color: #0f0; font-family: 'Trebuchet MS', sans-serif;">
        <p>Score: <span id="gameOverScore">0</span></p>
        <p>Player: <span id="gameOverPlayer">-</span></p>
      </div>
      <div class="menu-buttons">
        <button class="menu-btn" data-action="play-again">Play Again</button>
        <button class="menu-btn admin-only" data-action="change-player" style="display:none;">Change Player</button>
        <button class="menu-btn admin-only" data-action="new-player-gameover" style="display:none;">New Player</button>
        <button class="menu-btn" data-action="back-to-menu">Back to Menu</button>
      </div>
    </div>
  </div>

  <!-- PLAY MENU OVERLAY -->
  <div id="playMenu" role="dialog" aria-label="Play Menu" class="menu-overlay">
    <div class="menu-panel">
      <h2>Play Menu</h2>
      <div class="menu-buttons">
        <button class="menu-btn" data-action="existing-player">1. Existing Player</button>
        <button class="menu-btn" data-action="new-player">2. New Player</button>
        <button class="menu-btn admin-only" id="listPlayersBtn" data-action="list-players" style="display:none;">3. List of Players</button>
        <button class="menu-btn admin-only" id="asteroidsBtn" data-action="asteroids" style="display:none;">4. Asteroids</button>
        <button class="menu-btn" data-action="back">5. Back</button>
      </div>
    </div>
  </div>

  <!-- PLAYERS LIST OVERLAY -->
  <div id="playersListMenu" role="dialog" aria-label="Players List" class="menu-overlay">
    <div class="menu-panel">
      <h2>Players List</h2>
      <div id="playersListContent" class="players-list-content"></div>
      <button class="menu-btn" data-action="back-players-list">Back</button>
    </div>
  </div>

  <!-- SCOREBOARD OVERLAY -->
  <div id="scoreboardMenu" role="dialog" aria-label="Scoreboard" class="menu-overlay">
    <div class="menu-panel">
      <h2>Scoreboard</h2>
      <div id="scoreboardList" class="scoreboard-list"></div>
      <button class="menu-btn" data-action="back-scoreboard">Back</button>
    </div>
  </div>

  <!-- ASTEROIDS MANAGER OVERLAY -->
  <div id="asteroidsMenu" role="dialog" aria-label="Asteroid Manager" class="menu-overlay">
    <div class="menu-panel">
      <h2>Asteroids</h2>
      <div class="menu-buttons">
        <button class="menu-btn" data-action="list-asteroids">1. List Asteroids</button>
        <button class="menu-btn" data-action="add-asteroid">2. Add Asteroid</button>
        <button class="menu-btn" data-action="delete-asteroid">3. Delete Asteroid</button>
        <button class="menu-btn" data-action="random-asteroid">4. Add Random Asteroid</button>
        <button class="menu-btn" data-action="back-asteroids">5. Back</button>
      </div>
    </div>
  </div>

  <!-- ASTEROIDS LIST OVERLAY -->
  <div id="asteroidsList" role="dialog" aria-label="Asteroids List" class="menu-overlay">
    <div class="menu-panel">
      <h2>Asteroids List</h2>
      <div id="asteroidsListContent" class="asteroids-list-content" style="max-height: 300px; overflow-y: auto;"></div>
      <button class="menu-btn" data-action="back-list">Back</button>
    </div>
  </div>

  <!-- GENERATE DATA OVERLAY -->
  <div id="generateMenu" role="dialog" aria-label="Generate Data" class="menu-overlay">
    <div class="menu-panel">
      <h2>Generate Sample Data</h2>
      <div class="form-group">
        <label for="playerCount">Number of players:</label>
        <select id="playerCount">
          <option value="0">0</option>
          <option value="1">1</option>
          <option value="2">2</option>
        </select>
      </div>
      <div class="form-group">
        <label for="asteroidCount">Number of asteroids:</label>
        <select id="asteroidCount">
          <option value="0" selected>0</option>
          <option value="1">1</option>
          <option value="2">2</option>
        </select>
      </div>
      <button class="menu-btn" data-action="generate-confirm">Generate</button>
      <button class="menu-btn" data-action="back-generate">Cancel</button>
    </div>
  </div>

  <!-- INSTRUCTIONS MODAL -->
  <div id="instructionsModal" class="menu-overlay">
    <div class="menu-panel">
      <h2>How to Play</h2>
      <div style="text-align: left; margin: 20px 0;">
        <ul>
          <li>Use <strong>Arrow Up</strong> to move up</li>
          <li>Use <strong>Arrow Down</strong> to move down</li>
          <li>Avoid all asteroids</li>
          <li>Survive as long as possible to increase high score</li>
          <li>Press <strong>P</strong> to pause/resume</li>
          <li>Press <strong>R</strong> to restart after Game Over</li>
        </ul>
      </div>
      <button class="menu-btn" data-action="back-instructions">Back</button>
    </div>
  </div>

  <!-- INPUT DIALOG MODAL -->
  <div id="inputModal" class="menu-overlay">
    <div class="menu-panel input-modal-panel">
      <h2 id="inputModalTitle">Enter Input</h2>
      <div class="input-form">
        <input type="text" id="inputModalField" placeholder="Enter text" class="input-field">
        <div class="input-buttons">
          <button class="menu-btn" id="inputModalOk">OK</button>
          <button class="menu-btn" id="inputModalCancel">Cancel</button>
        </div>
      </div>
    </div>
  </div>

  <!-- CONFIRM DIALOG MODAL -->
  <div id="confirmModal" class="menu-overlay">
    <div class="menu-panel confirm-modal-panel">
      <h2 id="confirmModalTitle">Confirm</h2>
      <p id="confirmModalMessage" style="color: #0f0; margin: 20px 0; font-family: 'Trebuchet MS', sans-serif;"></p>
      <div class="confirm-buttons">
        <button class="menu-btn" id="confirmModalYes">Yes</button>
        <button class="menu-btn" id="confirmModalNo">No</button>
      </div>
    </div>
  </div>

  <!-- ALERT DIALOG MODAL -->
  <div id="alertModal" class="menu-overlay">
    <div class="menu-panel alert-modal-panel">
      <h2 id="alertModalTitle">Alert</h2>
      <p id="alertModalMessage" style="color: #0f0; margin: 20px 0; font-family: 'Trebuchet MS', sans-serif;"></p>
      <button class="menu-btn" id="alertModalOk" style="max-width: 200px; margin: 0 auto;">OK</button>
    </div>
  </div>


  <!-- MAIN GAME SCRIPT -->
  <script type="module" src="js/menu.js"></script>
  <script type="module" src="js/main.js"></script>

</body>
</html>